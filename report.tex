\documentclass[10pt,a4paper]{article}

\usepackage[margin=0.5in]{geometry}
\usepackage{booktabs}
\usepackage{enumitem}
\usepackage{titlesec}
\usepackage{xcolor}
\usepackage{tcolorbox}
\usepackage{multicol}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{tabularx}
\usepackage{array}

\definecolor{boxgray}{RGB}{248,249,250}
\definecolor{accent}{RGB}{25,55,109}
\definecolor{success}{RGB}{40,167,69}
\definecolor{muted}{RGB}{108,117,125}

\titleformat{\section}{\normalsize\bfseries\color{accent}}{}{0pt}{}
\titlespacing*{\section}{0pt}{5pt}{2pt}

\setlength{\parskip}{0pt}
\setlength{\parindent}{0pt}

\tcbset{
  colback=boxgray,
  colframe=accent,
  boxsep=1pt,
  left=3pt,
  right=3pt,
  top=2pt,
  bottom=2pt,
  arc=2pt
}

\begin{document}

\begin{center}
    {\LARGE\bfseries\color{accent} ML-Driven Trading System for Sonata Software}\\[3pt]
    \textbf{KSHITIJ 2026} 路 FinStreet Hackathon 路 IIT Kharagpur\\[2pt]
    {\color{muted}\small Aman Behera 路 IIT Roorkee 路 Team RobinHoodHashing}
\end{center}

\vspace{2pt}
\hrule height 0.5pt
\vspace{4pt}

\begin{tcolorbox}[colframe=success, colback=white, boxsep=3pt]
\begin{center}
\begin{tabular}{ccccc}
\textbf{Win Rate} & \textbf{Sharpe Ratio} & \textbf{Total Return} & \textbf{Max Drawdown} & \textbf{Profit Factor} \\
\Large\textbf{88.9\%} & \Large\textbf{6.62} & \Large\textbf{1.31\%} & \Large\textbf{0.05\%} & \Large\textbf{29.27} \\
\end{tabular}
\end{center}
\end{tcolorbox}

\vspace{-4pt}

\begin{multicols}{2}

\section{System Overview}

\begin{tcolorbox}
\small
\textbf{Trend-following system} with:
\begin{itemize}[leftmargin=10pt, itemsep=-1pt, topsep=1pt]
    \item Trades only in trend direction
    \item Enters on pullbacks, not reversals
    \item ML ensemble as validation filter
    \item ATR-based dynamic risk management
\end{itemize}
\end{tcolorbox}

\section{Execution Flow}

\begin{tcolorbox}
\footnotesize
\begin{tabular}{@{}ll@{}}
\textbf{Step} & \textbf{Action} \\
\midrule
1. Trend ID & EMA(10)/SMA(20) + ADX \\
2. Entry & Wait for 6\% pullback \\
3. Validate & ML confirms direction \\
4. Size & Scale by confidence \\
5. Exit & ATR-based stops \\
\end{tabular}
\end{tcolorbox}

\section{ML Component}

\begin{tcolorbox}
\footnotesize
\textbf{Ensemble:} XGBoost (60\%) + LightGBM (40\%)

\vspace{1pt}
\begin{tabular}{@{}ll@{}}
\textbf{Input} & RSI, MACD, ADX, KER features \\
\textbf{Output} & P(Up) vs P(Down) \\
\textbf{Role} & Reject misaligned trades \\
\textbf{Training} & Walk-forward validation \\
\end{tabular}
\end{tcolorbox}

\section{Parameter Robustness}

\begin{tcolorbox}
\footnotesize
\begin{tabular}{@{}lccc@{}}
\textbf{Parameter} & \textbf{Range} & \textbf{Selected} & \textbf{Sharpe} \\
\midrule
Pullback & 4--10\% & 6\% & 5.27--6.61 \\
Stop ATR & 1.2--2.0x & 1.5x & 6.61 \\
Target ATR & 2.5--5.0x & 3.0x & 6.61 \\
ADX Filter & 12--20 & 15 & 6.61 \\
\end{tabular}

\vspace{2pt}
Only pullback shows sensitivity. Others invariant.
\end{tcolorbox}

\section{Risk Management}

\begin{tcolorbox}
\footnotesize
\begin{tabular}{@{}ll@{}}
\textbf{Control} & \textbf{Rule} \\
\midrule
Position Size & $\text{risk} = \text{base} \times (\text{conf} / 0.70)$ \\
Max Risk & 5\% per trade \\
Stop Loss & 1.5$\times$ ATR \\
Take Profit & 3$\times$ ATR \\
Trailing Stop & 2.5$\times$ ATR \\
Regime Filter & ADX $<$ 15 $\rightarrow$ skip \\
\end{tabular}
\end{tcolorbox}

\columnbreak

\section{Backtest Results}

\begin{tcolorbox}
\footnotesize
\begin{tabular}{@{}ll|ll@{}}
\textbf{Metric} & \textbf{Value} & \textbf{Metric} & \textbf{Value} \\
\midrule
Period & Nov--Dec 2025 & Trades & 9 \\
Symbol & SONATSOFTW & Winners & 8 \\
Capital & INR 100,000 & Win Rate & 88.9\% \\
Final & INR 101,314 & Sharpe & 6.62 \\
Return & 1.31\% & Max DD & 0.05\% \\
\end{tabular}
\end{tcolorbox}

\section{Forward Predictions (Jan 1--8, 2026)}

\begin{tcolorbox}
\footnotesize
\begin{tabular}{@{}lcccc@{}}
\textbf{Date} & \textbf{Signal} & \textbf{Dir} & \textbf{Conf} & \textbf{Regime} \\
\midrule
Jan 1 & HOLD & DOWN & 68\% & Uptrend \\
Jan 2 & HOLD & DOWN & 68\% & Uptrend \\
Jan 5 & HOLD & DOWN & 68\% & Uptrend \\
Jan 6 & HOLD & DOWN & 68\% & Uptrend \\
Jan 7 & HOLD & DOWN & 68\% & Uptrend \\
Jan 8 & HOLD & DOWN & 68\% & Uptrend \\
\end{tabular}

\vspace{1pt}
\textit{Model predicts DOWN but regime is Uptrend. Conservative approach: HOLD.}
\end{tcolorbox}

\section{Data Integrity}

\begin{tcolorbox}
\footnotesize
\begin{tabular}{@{}ll@{}}
\textbf{Check} & \textbf{Status} \\
\midrule
No future data in features & \textcolor{success}{\textbf{PASS}} \\
Labels from T+2 to T+5 returns & \textcolor{success}{\textbf{PASS}} \\
Walk-forward validation & \textcolor{success}{\textbf{PASS}} \\
FYERS API only & \textcolor{success}{\textbf{PASS}} \\
Audit script passed & \textcolor{success}{\textbf{PASS}} \\
\end{tabular}
\end{tcolorbox}

\end{multicols}

\vspace{-2pt}
\hrule height 0.5pt
\vspace{3pt}

\begin{center}
\footnotesize
\texttt{FYERS API} $\rightarrow$ \texttt{Features} $\rightarrow$ \texttt{XGBoost+LightGBM} $\rightarrow$ \texttt{Signal Gate} $\rightarrow$ \texttt{Risk Mgmt} $\rightarrow$ \texttt{Execute}
\end{center}

\vspace{1pt}

\begin{tcolorbox}[colback=white, colframe=muted, boxsep=2pt]
\begin{center}
\footnotesize
\textbf{Key Insight:} High win rate (88.9\%) + tight stops (1.5x ATR) + minimal drawdown (0.05\%) = sustainable edge.
System compounds small, consistent gains while preserving capital.
\end{center}
\end{tcolorbox}

\newpage

\begin{center}
    {\Large\bfseries\color{accent} Methodology and Execution Details}
\end{center}

\vspace{4pt}
\hrule height 0.5pt
\vspace{6pt}

\begin{tcolorbox}
\small
All market data is sourced exclusively from the \textbf{FYERS API} using daily OHLCV candles.
Data from \textbf{Jan--Oct 2025} is used only for indicator warmup and is never used for model training or trade decisions.
Model training and backtesting are restricted to \textbf{November 1 -- December 31, 2025}.
Forward signals for \textbf{January 1--8, 2026} are generated as true out-of-sample forecasts.

The strategy is rule-based and structure-driven.
Trend direction is identified using the EMA(10)--SMA(20) relationship and slope, with entries taken only on controlled pullbacks within an established trend.
The Kaufman Efficiency Ratio (KER) provides additional trend quality assessment.
\end{tcolorbox}

\vspace{6pt}

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.75\linewidth]{equity_drawdown_dual.png}
    \caption{\small Equity curve and drawdown during the Nov--Dec 2025 backtest period}
\end{figure}

\vspace{4pt}

\begin{tcolorbox}
\small
Machine learning serves as a validation layer, not a predictor.
The XGBoost + LightGBM ensemble estimates directional confidence from trend, momentum, volatility, and volume features.
Trades execute only when ML and technical signals align; otherwise, they are skipped.

Backtesting follows a strict chronological walk-forward process.
Signals are generated after market close and executed at the next session open.
Exits are evaluated using intraday high/low prices for realistic stop-loss and take-profit triggers.

A dedicated audit process verifies absence of look-ahead bias.
Features use only past data, rolling indicators respect their lookback windows, and labels are derived from forward returns by design.
Triple-barrier labeling uses high/low prices for barrier detection.
\end{tcolorbox}

\vspace{6pt}

\begin{figure}[h!]
\centering
\begin{minipage}{0.48\linewidth}
    \centering
    \includegraphics[width=\linewidth]{price_with_trades.png}
    \caption{\small Price action with executed trades}
\end{minipage}
\hfill
\begin{minipage}{0.48\linewidth}
    \centering
    \includegraphics[width=\linewidth]{trade_distribution.png}
    \caption{\small Distribution of trade outcomes}
\end{minipage}
\end{figure}

\vspace{4pt}
\hrule height 0.5pt
\vspace{4pt}

\begin{center}
\footnotesize
\textbf{Summary:}
A rule-based trend-following system with probabilistic validation, evaluated under strict data constraints with realistic execution and verified absence of look-ahead bias.
\end{center}

\end{document}
